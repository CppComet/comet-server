<rst>RU::004-Администрирование::005-Настройка файла comet.ini</rst>

====== Настройка файла comet.ini ======

 * Параметры можно задавать в любом порядке. 
 * Регистр важен
 * Комментарий начинается с символа `;`

<note important>Статья расчитана на версию [[https://github.com/CppComet/comet-server/releases/tag/3.22|CppComet 3.22]] и старше</note>
====== Секция [main] ======
 
Пароль для доступа из cometQL
<code>password = 0000000000000000000000000000000000000000000000000000000000000000</code>

Максимальный размер буфера в байтах для работы с сообщениями
<code>buf_size = 10384</code>

Размер буфера в байтах для хранения фрагментированных сообщений  
<code>fragment_buf_size = 600</code>

Максимальный размер буфера хранения фрагментированных сообщений  
<code>fragment_buf_max_size = 10384</code>

Надо ли выводить в лог комет сервера запросы приходящие через cometQL
<code>useQueryLoger = false</code>

Максимальный размер буфера для ответа на запрос
<code>answer_buf_size = 1000000</code>

Комет сервер может отдавать статические файлы. По умолчанию такая возможность отключена. Но если задать параметр base_dir то он начнёт отдавать файлы по имени из этой дерриктории как примитивный http сервер. Поддерживает только get запросы. В секции [content-type] можно задать соответсвие расширения заголовку content-type
<code>base_dir = /var/www/html</code>
====== Секция [statistics] ======

В комет сервере есть механизм сбор статистики использования и отправки на сервер разработчика ( Для чего и какие данные отправляет смотрите здесь http://statistics.comet-server.ru/api/statistics )
Чтоб отключить отправку статистики надо выставить значение false
<code>allow = true</code>

====== Секция [db] ======
Подключение к бд mysql
<code>host = localhost
user = root
password = root
name = comet_db
port = 3305</code>

====== Секция [ws] ======
ip адрес для приёма соединений с вебсокетов
<code>ip = 0.0.0.0</code>

Количество потоков в которые обрабатываются соединения с вебсокетов, каждый поток увеличивает общее потребление памяти примерно 10 - 15 мб так что для малонагруженной конфигурации можно казывать 1 поток
<code>thread_num = 4</code>

Комет сервер учитывает количество соединений онлайн и количество сетевых событий, это интервал в секундах между замерами значение 0 не замерять
<code>statistics = 10</code>

Порт для прослушивания подключений по вебсокетам
<code>port = 8087</code>

Интервал в секундах для проверки uptime у подключений, 0 не запускать проверку
<code>uptimeTestInterval = 600</code>

Максимальный uptime подключения после которого соединение разрывается принудительно 
<code>maxUptime = 0</code>

Список хостов через запятую с которых разрешено подключатся из javascript api (проверяется на основе http заголовка ) по умолчанию ограничения нет
<code>host = *</code>

====== Секция [cometql] ======
<code>ip = 0.0.0.0 
thread_num = 3 ; number of threads for receive message from cometql
statistics = 10
port = 3300
uptimeTestInterval = 600  
maxUptime = 0  </code>
  
====== Секция [content-type] ======  

Позволяет задать соответсвие content-type и типа файла. 

на пример так:
<code>js = text/javascript
css = text/css</code>
====== Секция [log] ======
Настройка уровня логирования чем выше число тем больше логов сыпится. 
 * 0 - не выводить
 * 100  - критические ошибки
 * 200  - ошибки
 * 300  - предупреждения
 * 400  - лог
 * 500 - режим отладки

Параметр выставляет общий для всех подсистем максимальный уровень логирования
<code>level = 200; </code>
 
Уровни логирования для отдельных подсистем для того чтоб было можно смотреть лог по отдельности для разных событий используется для удобства отладки
<code>Any = 500</code>

События от класса логера
<code>TagLoger = 500</code>

События класса хранения настроек
<code>appConf  = 500</code>

События от класса взаимодействия через pipe (в операционной системе)
<code>pipeCommands = 500</code>

Модуль сбора статистики
<code>statistics = 500</code>

Отключение соединений по превышению uptime
<code>removeOldConnections = 500</code>

Работа с mysql
<code>MySqlServer = 500</code>

Класс работы с данными пользователей (авторизация, время последнего онлайна)
<code>UserIndex = 500</code>

Класс пользователя (авторизация, время последнего онлайна)
<code>UserItem = 500</code>

Работа с вебсокетами
<code>ClientServer = 500</code>

Устаревшая секция работы с php api 
<code>ServerServer = 500</code>

Работа с редис (устаревшая секция)
<code>SimpleRedisClient = 500</code>

Приём и распределение сетевых соединений
<code>tcpServer = 500</code>

Заготовки кластеризапции ещё не всё готово
<code>CometQLCluster = 500</code>

Работа с авторизацией от cometql подключений
<code>devManager = 500</code>

Отправка запросов к бд mysql
<code>dbLink = 500</code>
